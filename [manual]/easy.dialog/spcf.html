<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link type="text/css" rel="stylesheet" href="../res/css/easy.library.css" />
    <link type="text/css" rel="stylesheet" href="../res/css/offline.window.css" />
    <title>Easy Dialog — Specification</title>
</head>
<body>
<div class="em_AROUND">
    <h1>easy.dialog.qsp v 2.0</h1>
    <div class="em_PAGE">
        <p>Модуль интерпретации диалогов.</p>


            <a id="short-specification"></a><h2>Краткое описание</h2>

            <a id="terms"></a><h3>Термины и понятия</h3>

            <p class="em_TERMIN"><span>Тег</span> — особая метка в тексте, отмечающая вхождение рассматриваемого текста. Теги могут быть открывающие и закрывающие, а так же одиночные. Комплекс из открывающего и закрывающего тегов может называться двойным тегом или сдвоенным тегом.</p>
            <p class="em_TERMIN"><span>Содержимое тега</span> — рассматриваемый текст, место вхождения которого обозначено тегами или тегом. Может использоваться понятие "значение тега". Числовое значение здесь условно обозначается <span class="emTEXT">[#значение]</span>, а текстовое - <span class="emTEXT">[$значение]</span>. Вместо слова "значение" может употребляться "число", "текст", "шестнадцатеричное число", и другие слова и словосочетания. Если содержимое тега принимает конечное число значений, это будет показано перечислением этих значений через вертикальную черту в квадратных скобках <span class="emTEXT">[одно значение|второе значение|третье значение]</span>.</p>
            <p class="em_TERMIN"><span>Команда</span> — слово или группа слов, которые провоцируют выполнение определённых операций или действий, запуск механизмов.</p>
            <p class="em_TERMIN"><span>Конструкция</span> — текст, записанный по определённым правилам.</p>
            <p class="em_TERMIN"><span>Реплика</span> — текст, заключённый между тегами реплик. Может включать в себя произносимую фразу, другие теги, команды, конструкции.</p>
            <p class="em_TERMIN"><span>Герой</span> — персонаж, которым непосредственно управляет игрок.</p>
            <p class="em_TERMIN"><span>Актёр</span> — персонаж, которым игрок не может управлять непосредственно.</p>
            <p class="em_TERMIN"><span>Текст реплики</span> — фраза героя или актёра, которая будет выведена на экран после обработки реплики. Текст реплики (иногда называется просто "фраза") - единственное содержимое реплики, которое не нужно облекать в специальные конструкции, или помещать между тегами.</p>
            <p class="em_TERMIN"><span>Интерпретация реплики</span> — процесс извлечения всех конструкций и текста реплики из реплики, а так же выполнение конструкций и команд, воспроизведение фразы в виде текста, выводимого на экран. За интерпретацию реплики отвечает процедура <span class="emTEXT">dialog.replic.int</span>.</p>
            <p class="em_TERMIN"><span>Пустая реплика</span> — реплика, в которой отсутствует фраза.</p>
            <p class="em_TERMIN"><span>Узел</span> — реплика, в которую вложена другая реплика.</p>
            <p class="em_TERMIN"><span>Родительская реплика</span> — так называется узел по отношению к реплике, которая в него вложена. <i>Реплика "F" - родительская реплика реплики "A".</i> Ещё называется родителем. Всякий узел является родителем вложенной в него реплики.</p>
            <p class="em_TERMIN"><span>Дочерняя реплика</span> — так называется реплика по отношению к реплике, в которую она вложена. <i>Реплика "A" - дочерняя реплика реплики "F".</i> Всякая реплика, вложенная в узел, является дочерней.</p>
            <p class="em_TERMIN"><span>Корень</span> — текст, помещённый вне тегов реплик. Может называться также корневой репликой, нулевой репликой, начальной репликой или заголовком диалога.</p>
            <p class="em_TERMIN"><span>Дефолтное значение</span> — значение тега, которое было указано в заголовке диалога, либо значение по умолчанию.</p>
            <p class="em_TERMIN"><span>Значение по умолчанию</span> — значение, которое будет возвращено механизмом модуля easy.dialog, если не указано, или ошибочно указано другое значение. Значения по умолчанию встроены в движок.</p>
            <p class="em_TERMIN"><span>Уровень</span> — счёт вложений реплик, степень вложения реплики. Если реплика вложена в корень - первый уровень. Если реплика вложена в реплику, вложенную в корень, - второй уровень. И так далее. Верхним уровнем при этом считается корень.</p>
            <p class="em_TERMIN"><span>Ответвления</span> — одноуровненвые реплики, вложенные в один и тот же узел.</p>
            <p class="em_TERMIN"><span>Ветка</span> — ответвление вместе со всеми вложенными в него репликами.</p>
            <p class="em_TERMIN"><span>Финал</span> — реплика, в которую не вложено ни одной другой реплики. Называется так же финальной репликой, конечной репликой, или последней репликой.</p>
            <p class="em_TERMIN"><span>Тело диалога</span> — текст, содержащий хотя бы одну реплику помимо корня.</p>

            <a id="tags-constructions-commands"></a><h3>Теги, конструкции, команды</h3>

            <p><span class="emTEXT">{:<span class="emTEXT">[$текст]</span>:}</span> — теги, между которыми записываются реплики неиграбельных персонажей (далее: актёры, неписи, NPC, персонажи). Текст реплики выводится на экран автоматически. Теги реплики актёра.</p>
            <p><span class="emTEXT">[:<span class="emTEXT">[$текст]</span>:]</span> — теги, между которыми записываются реплики персонажа, которым управляет игрок (далее - герой). Выводятся на экран в виде доступных игроку действий. При выборе действия, на экран выводится текст реплики. Теги реплики героя.</p>
            <div class="em_STEP">
                <p><span class="emTEXT">npc="<span class="emTEXT">[$настройки]</span>"</span> — конструкция, в которую помещаются настройки вывода фраз актёра.</p>
                <p><span class="emTEXT">hero="<span class="emTEXT">[$настройки]</span>"</span> — конструкция, в которую помещаются настройки форматирования и формирования фраз героя.</p>
                <div class="em_STEP">
                    <p>Настройки формирования и форматирования фраз актёров и героя:</p>
                    <p><span class="emOPRT">name:<span class="emOPRT">[$значение]</span>:name</span> — двойной тег установки имени актёра или героя (в зависимости от того, в какую конструкцию помещено). Если указать пустое значение (между двоеточиями нет ничего), имя не будет выводиться. Если не указывать, будет выводиться имя, указанное в родительской реплике, либо дефолтное имя. Значением может быть любое сочетание пробельных и непробельных символов. Не рекомендуется использовать символ перевода строки.</p>
                    <p><span class="emOPRT">ncolor:<span class="emOPRT">[$значение]</span></span> — одиночный тег настройки цвета имени актёра или героя (в зависимости от того, в какую конструкцию помещено). Значением может выступать запись из шести шестнадцатеричных цифр. Формат цвета как в html: <span class="em_RED">RR</span><span class="emTEXT">GG</span><span class="emOPRT">BB</span>. Если не указывать, или оставить значение пустым, будет выводиться значение родительской реплики, или дефолтное.</p>
                    <p><span class="emOPRT">fcolor:<span class="emOPRT">[$значение]</span></span> — одиночный тег настройки цвета непосредственно фразы актёра или героя (в зависимости от того, в какую конструкцию помещено). Значением может выступать запись из шести шестнадцатеричных цифр. Формат цвета как в html: <span class="em_RED">RR</span><span class="emTEXT">GG</span><span class="emOPRT">BB</span>. Если не указывать, или оставить значение пустым, будет выводиться значение родительской реплики, или дефолтное.</p>
                    <p><span class="emOPRT">nattrib:<span class="emOPRT">[$значение]</span></span> — одиночный тег настройки стиля начертания шрифта имени актёра или героя (в зависимости от того, в какую конструкцию помещено). Значением выступают команды аттрибутов, в любом количестве. Если не указывать, или оставить значение пустым, будет выводиться значение родительской реплики, или дефолтное.</p>
                    <p><span class="emOPRT">fattrib:<span class="emOPRT">[$значение]</span></span> — одиночный тег настройки стиля начертания шрифта фразы актёра или героя (в зависимости от того, в какую конструкцию помещено). Значением выступают команды аттрибутов, в любом количестве. Если не указывать, или оставить значение пустым, будет выводиться значение родительской реплики, или дефолтное:</p>
                    <div class="em_STEP">
                        <p>
                            <span class="em_DBLU">-b</span> — команда аттрибута, применяющая жирность к тексту.
                            <br><span class="em_DBLU">-i</span> — команда аттрибута, применяющая курсив к тексту.
                            <br><span class="em_DBLU">-n</span> — команда аттрибута, отменяющая жирность и курсив.
                        </p>
                        <p>Аттрибуты считываются в обратном порядке, начиная с последнего, таким образом происходит и применение. Допустим, мы не хотим, чтобы имя героя отображалось курсивом, но продолжало отображаться жирным шрифтом. Пишем "natrib:-b-n". Сначала шрифт вернётся к нормальному виду, потом будет применена жирность. Если указать "natrib:-n-b", то сначала будет применена жирность, а потом шрифт вернётся к нормальному виду. </p>
                    </div>
                    <p><span class="emOPRT">tire:<span class="emOPRT">[$значение]</span></span> — одиночный тег, значение которого определяет символ, выводимый перед фразой (знак мыслеотделительный, знак перед прямой речью). Если не указано, выводится значение родительской реплики, или дефолтное. Если тег и его значение отделяются от остального текста пробелами, можно указывать только непробельные символы. Чтобы использовать пробельные символы в качестве знака перед прямой речью, следует поместить тег и его значение в круглые скобки:</p>
                    <p class="em_CODE"><span class="emTEXT">(<span class="emOPRT">tire:<span class="emOPRT">[$значение]</span></span>)</span></p>
                    <p>Чтобы перед прямой речью не ставилось никаких знаков, следует использовать команду <span class="em_DBLU">nope</span>:</p>
                    <p class="em_CODE"><span class="emOPRT">tire:</span><span class="em_DBLU">nope</span></p>
                </div>
                <p><span class="emTEXT">replics="<span class="emTEXT">[$настройки]</span>"</span> — конструкция, в которую помещаются настройки выбора, обработки и вывода реплик.</p>
                <div class="em_STEP">
                    Настройки выбора, обработки и вывода реплик актёров и героя:
                    <p><span class="emOPRT">repeat:<span class="emOPRT">[one|once|cicle]</span></span> — одиночный тег, значение которого определяет настройки повтора фраз актёра из ответвлений. Можно использовать три команды:</p>
                    <div class="em_STEP">
                        <p>
                            <span class="em_DBLU">one</span> — всё время диалога будет выводиться фраза только одного из ответвлений.<br>
                            <span class="em_DBLU">once</span> — всякий раз будет выводиться фраза из ответвления, фраза которого ещё не выводилась. Когда такие ответвления закончатся, будет выводиться фраза ответвления, фраза из которого выводилась последний раз.<br>
                            <span class="em_DBLU">cicle</span> — всякий раз будет выводиться фраза из следующего ответвления. Когда закончатся ответвления, фразы из которых ещё не выводились, выбор следующего ответвления пойдёт с начала.
                        </p>
                </div>
                <p><span class="emOPRT">repeat:<span class="emOPRT">[random|straight]</span></span> — одиночный тег, значение которого определяет настройки выбора следующего ответвления для реплик актёра. Можно использовать две команды:</p>
                <div class="em_STEP">
                    <p>
                        <span class="em_DBLU">random</span> — случайный выбор ответвления.<br>
                        <span class="em_DBLU">straight</span> — выбор следующего ответвления в порядке очереди, в которой они записаны в теле диалога.
                    </p>
                </div>
                </div>
                <p><span class="emTEXT">iffing:<span class="emTEXT">[$условия]</span>:iffing</span> — сдвоенный тег, значение которого используется в качестве условия вывода реплики.</p>
                <p><span class="emTEXT">act-name:<span class="emTEXT">[$текст]</span>:act-name</span> — сдвоенный тег, значение которого используется в качестве названия действия при интерпретации реплики героя.</p>
                <p><span class="emTEXT">frase-block:<span class="emTEXT">[$текст]</span>:frase-block</span> — конструкция вывода блока последовательных фраз. Между тегами размещается набор строк, каждая из которых считается отдельной фразой. При этом если в начале фразы выставлен тег <span class="em_VIOL">&lt;npc-name&gt;</span>, к ней применяются настройки фразы актёра, если же в начале фразы выставлен тег <span class="em_VIOL">&lt;hero-name&gt;</span>, к ней применяются настройки фразы героя.</p>
                <p><span class="emTEXT">dynamic-code:<span class="emTEXT">[$текст]</span>:dynamic-code</span> — между этими тегами помещается обычный код QSP, который будет выполнен во время интерпретации реплики.</p>
                <p><span class="emTEXT">levelup:<span class="emTEXT">[#число]</span></span> — команда в виде одиночного тега, которая "возвращает" интерпретатор на несколько уровней вверх по узлам.</p>
                <p><span class="emTEXT">leveljump:<span class="emTEXT">[$метка]</span></span> — команда в виде одиночного тега, которая отправляет интерпретатор к реплике, содержащей указанную метку. Метка указывается в значении тега.</p>
                <p><span class="emTEXT">marker:<span class="emTEXT">[$метка]</span></span> — одиночный тег, значение которого считается меткой реплики.</p>
                <p><span class="em_DBLU">closeup</span> — команда, наличие которой в интерпретируемой реплике приведёт к закрытию диалога.</p>
                <p><span class="em_DBLU">selectact.delete</span> — команда, наличие которой в интерпретируемой реплике приведёт к удалению текущего действия из списка без обновления списка.</p>
                <p><span class="emCOMM">&lt;!--<span class="emCOMM">[$комментарий]</span>--&gt;</span> — открывающий и закрывающий теги комментария. В комментарии можно помещать всё, кроме фраз актёров и героя и других комментариев. Комментарии можно размещать в любом месте диалога, но не между тегами <span class="emTEXT">dynamic-code: :dynamic-code</span> и <span class="emTEXT">iffing: :iffing</span>. При наличии внутри комментариев описанных выше тегов и комманд, следует отделять их от тегов комментария хотя бы одним пробелом. Текст комментариев не выводится на экран.</p>
            </div>

            <h4>Планируемые решения</h4>

            <p style="font-size:0.7em;">Нижеследующие команды и конструкции возможно будут введены в версии модуля 2.0. Названия и принцип действия могут отличаться от приведённых ниже.</p>
            <div class="em_STEP">
                    <p><span class="emVAR">bwaiting:<span class="emVAR">[#миллисекунды]</span></span> — настройка задержки вывода на экран фраз из блока фраз. В настоящий момент задержка существует, но не настраивается из-под диалога. Предшествует каждой отдельной фразе в т.ч. и без указания тегов <span class="em_VIOL">&lt;npc-name&gt;</span> и <span class="em_VIOL">&lt;hero-name&gt;</span>.</p>
                    <p><span class="emVAR">bwaiting:<span class="emVAR">[#миллисекунды]</span></span> — настройка задержки вывода на экран текста реплики.</p>
                    <p><span class="emVAR">selectreplic.delete</span> — команда удаления реплики из диалога. Реплика удаляется из текущего диалога. Если закрыть и вновь открыть диалог, реплика вновь появится в ветке.</p>
                    <p><span class="emVAR">selectreplic.kill</span> — команда удаления реплики из диалога. Реплика удаляется из диалога насовсем. То есть если закрыть диалог, а потом вновь открыть, реплика не появится в ветке.</p>
                    <p><span class="emVAR">act-close="<span class="emVAR">[$настройки]</span>"</span> — конструкция, в которую помещаются настройки стандартного действия закрытия диалога. Стандартное действие - это действие, которое будет появляться в списке действий постоянно.</p>
                    <p><span class="emVAR">act-up="<span class="emVAR">[$настройки]</span>"</span> — конструкция, в которую помещаются настройки стандартного действия, возвращающего на несколько узлов вверх. В частности такое действие должно возвращать к последнему узлу, где обновлялся список действий.</p>
            </div>
            <p>Возможно будет введена конструкция описания стандартных действий/реплик героя, которые должны повторяться на протяжении всей ветки диалога. <span class="emVAR">act-standart="<span class="emVAR">[$настройки]</span>"</span> - вместо настроек перечисляются метки стандартных реплик. Сами реплики располагаются в скрытой ветке.</p>

            <a id="dialogs-construct"></a><h3>Конструирование диалога</h3>
            <a id="replics-construct"></a><h4>Конструирование реплик</h4>

            <p>Каждая реплика, за исключением корневой, должна быть помещена в теги реплики:</p>
            <div class="em_STEP">
                <ul>
                    <li><span class="emTEXT">{:<span class="emTEXT">[$текст]</span>:}</span>- для реплик актёра.</li>
                    <li><span class="emTEXT">[:<span class="emTEXT">[$текст]</span>:]</span>- для реплик героя.</li>
                </ul>
            </div>
            <P>Реплики могут включать в себя следующие элементы:</P>
            <div class="em_STEP">
                <ul>
                    <li>текст реплики
                    <li>конструкции настроек (<span class="emTEXT">npc="<span class="emTEXT">[$настройки]</span>"</span>, <span class="emTEXT">hero="<span class="emTEXT">[$настройки]</span>"</span>, <span class="emTEXT">replics="<span class="emTEXT">[$настройки]</span>"</span>)</li>
                    <li>конструкцию условия вывода реплики (<span class="emTEXT">iffing:<span class="emTEXT">[$условия]</span>:iffing</span>)</li>
                    <li>конструкцию динамического кода, выполняемого при интерпретации реплики (<span class="emTEXT">dynamic-code:<span class="emTEXT">[$текст]</span>:dynamic-code</span>)</li>
                    <li>конструкцию блока фраз (<span class="emTEXT">frase-block:<span class="emTEXT">[$текст]</span>:frase-block</span>)</li>
                    <li>конструкцию для замены имени действия (<span class="emTEXT">act-name:<span class="emTEXT">[$текст]</span>:act-name</span>)</li>
                    <li>команды <span class="emTEXT">levelup:<span class="emTEXT">[#число]</span></span>, <span class="emTEXT">leveljump:<span class="emTEXT">[$метка]</span></span>, <span class="em_DBLU">closeup</span>, <span class="em_DBLU">selectact.delete</span></li>
                    <li>тег метки <span class="emTEXT">marker:<span class="emTEXT">[$метка]</span></span></li>
                    <li>комментарий - один или несколько</li>
                </ul>
            </div>
            <p>При этом, всё, кроме текста реплики и комментариев, можно помещать внутри комментариев. Можно и не помещать.</P>
            <p>Вышеперечисленные элементы могут отсутствовать в реплике. Если в реплике нет ни одного из вышеперечисленных элементов, механизмы модуля всё равно будут воспринимать её, как обычную реплику, т.е. пытаться интерпретировать.</p>
            <p>Реплики могут включать другие реплики, помещённые в теги реплик. На этом построен механизм интерпретации последовательности вложенных реплик.</p>

            <a id="comments"></a><h4>Комментирование</h4>
            <P>Для того, чтобы писать комментарии в теле диалога и в его заголовке, была введена конструкция комментариев из html. Комментарии представляют собой запись между открывающим тегом "<span class="emCOMM">&lt;!--</span>" и закрывающим "<span class="emCOMM">--&gt;</span>". Эти теги так и называются: теги комментария. Название "тег комментария", если не уточняется открывающий или закрывающий, означает тоже самое.</P>
            <p>Комментарии могут быть как однострочными, так и многострочными.</p>
            <p>Отделять содержимое комментария от его тегов следует хотя бы одним пробельным символом или переводом строки.</p>
            <p>Нельзя размещать комментарии внтури комментариев. Запись</p>
            <p class="em_CODE">
                <span class="emCOMM">&lt;!-- текст комментария <span class="emCOMM">&lt;!-- текст вложенного комментария --&gt;</span> текст комментария --&gt;</span>
            </p>
            <p>недопустима.</p>
            <p>Недопустимо также использовать комментарии между тегами <span class="emTEXT">dynamic-code:&nbsp;:dynamic-code</span> и <span class="emTEXT">iffing:&nbsp;:iffing</span>, поскольку между ними помещается чистый код QSP.</p>
            <p>В тегах <span class="emTEXT">act-name:&nbsp;:act-name</span>, в конструкциях блоков фраз, а также в самих фразах комментарии допустимы, поскольку игнорируются html-рендерером QSP-плеера как нормальные html-комментарии.</p>
            <p>Все команды и конструкции реплики, кроме фразы, допустимо и желательно помещать в комментарии. Лучше всего - в один. В таких комментариях будет игнорироваться весь текст, помимо текста самих конструкций и настроек.</p>
            <p>Внутри конструкций настроек (<span class="emTEXT">npc="<span class="emTEXT">[$настройки]</span>"</span>, <span class="emTEXT">hero="<span class="emTEXT">[$настройки]</span>"</span>, <span class="emTEXT">replics="<span class="emTEXT">[$настройки]</span>"</span>) допустимо произвольное комментирование без использования тегов комментария. Весь текст, помимо тегов настроек и их значений, будет проигнорирован механизмом извлечения настроек. Необходимо лишь отделять значение тегов от произвольного текста хотя бы одним пробелом, символом перевода строки или табуляции.</p>
            <p>Если вы включаете в комментарий команду или одиночный тег, озаботьтесь отделить команду, одиночный тег или его значение от тегов комментария хотя бы одним пробелом (табуляцией или переводом строки).</p>

            <a id="settings"></a><h4>Конструирование настроек</h4>
            <p>В настоящей версии модуля для настроек предусмотрены три конструкции. Конструкции <span class="emTEXT">npc="<span class="emTEXT">[$настройки]</span>"</span> и <span class="emTEXT">hero="<span class="emTEXT">[$настройки]</span>"</span> сходны по своему содержанию и используют одинаковые команды и теги. Конструкция <span class="emTEXT">replics="<span class="emTEXT">[$настройки]</span>"</span> предполагает другой набор команд и тегов. Однако правила записи всех треёх конструкций одинаковы.</p>
            <P>Вместо двойного аппострофа для записи конструкций можно использовать одиночный апостроф:</P>
            <p class="em_CODE"><span class="emTEXT">npc='<span class="emTEXT">[$настройки]</span>'</span><br>
                <span class="emTEXT">hero='<span class="emTEXT">[$настройки]</span>'</span><br>
                <span class="emTEXT">replics='<span class="emTEXT">[$настройки]</span>'</span></p>
            <p>Между апострофами можно размещать любой текст и количество строк. Весь текст, кроме команд, тегов и их содержимого, будет игнорироваться при извлечении настроек.</p>
            <P>Каждую команду, тег и его содержимое нужно отделять от прочего текста хотя бы одним пробелом или переводом строки.</P>
            <p>Теги и команды можно располагать в произвольном порядке, это никак не скажется на чтении их содержимого.</p>
            <p>Если в тексте настроек два и более раз написан один и тот же тег, используется значение тега, расположенного ближе к началу текста настроек.</p>
            <p>Если в тексте настроек не указан какой-либо из тегов, его значением будет считаться значение, полученное от родительской реплики или дефолтное значение. Если это заголовок диалога, значением тега будет принято значение по умолчанию.</p>
            <p>Теги настроек и их значения желательно помещать в круглые скобки. Можно в квадратные, угловые и фигурные, но предпочтительней круглые.</p>

            <a id="tegs_and_their_opinion"></a><h4>Теги и их значения</h4>
            <p>Значением сдвоенного тега считается весь текст с самого первого символа сразу после открывающего тега, до последнего символа включительно перед закрывающим тегом. В зависимости от назначения тега, пробельные символы и переводы строки в начале значения, будут игнорироваться или напротив - включаться в значение.</p>
            <p>Игнорируются все переводы строк и пробельные символы непосредственно после открывающего тега и непосредственно перед закрывающим для:</p>
            <ul>
                <li>тегов реплик <span class="emTEXT">{: :}</span> и <span class="emTEXT">[: :]</span></li>
                <li>тегов <span class="emTEXT">iffing:&nbsp;:iffing</span></li>
                <li>тегов <span class="emTEXT">dynamic-code:&nbsp;:dynamic-code</span></li>
                <li>тегов <span class="emTEXT">frase-block:&nbsp;:frase-block</span></li>
            </ul>
            <p>Все переводы строк и пробельные символы сохраняются при получении и обработке значений для:</p>
            <ul>
                <li>тегов <span class="emOPRT">name:&nbsp;:name</span></li>
                <li>тегов <span class="emTEXT">act-name:&nbsp;:act-name</span></li>
                <li>тегов <span class="emCOMM">&lt;!--&nbsp;--&gt;</span></li>
            </ul>
            <p>Это связано всего лишь с методами распознавания содержимого.</p>
            <p>Таким образом в качестве значения сдвоенного тега может использоваться абсолютно любой набор символов. Можно включать в значение тега (в зависимости от нужд) переводы строк, пробелы и символы табуляции.</p>
            <P>Ни в коем случае нельзя включать одинаковые сдвоенные теги друг в друга. Запись типа</P>

        <p class="em_PF"><span class="emTEXT">                frase-block:
                    Фраза
                    <span class="em_RED">frase-block:
                        фраза фраза фраза
                    :frase-block</span>
                    Ещё одна фраза
                :frase-block</span></p>

            <p>недопустима.</P>
            <p>Значением одиночного тега считается весь текст, начиная с первого символа непосредственно сразу после тега и заканчивая включительно символом, стоящим перед первым встреченным пробельным символом или переводом строки.</p>
            <p>Таким образом в одиночные теги можно помещать только непробельные символы.</p>
            <p>Однако, если одиночный тег и его содержимое заключены в скобки, причём между открывающей скобкой и тегом нет пробелов и переводов строки, в значении тега можно использовать и пробелы и переводы строки.</p>
            <p>Если же одиночный тег и его значение записываются без скобок, они должны отделяться от остального текста хотя бы одним пробелом или переводом строки.</p>
            <p>Если одиночный тег помещается в сдвоенный тег и не заключается в скобки, он должен отделяться от тегов сдвоенного тега хотя бы одним пробелом. Запись типа</p>
            <p class="em_PF"><span class="emCOMM">      &lt;!-<span class="em_RED">-n</span>color:88888<span class="em_RED">8-</span>-&gt;</span></p>
            <p>недопустима.</p>
            <p>&nbsp;</p>
            <p>Можно использовать запись</p>
            <p class="em_PF"><span class="emCOMM">      &lt;!--&nbsp;ncolor:888888&nbsp;--&gt;</span></p>
            <p>или</p>
            <p class="em_PF"><span class="emCOMM">      &lt;!--(nolor:888888)--&gt;</span></p>
            <a id="dialogs"></a><h4>Составление диалогов</h4>
            <p>Диалоги составляются из реплик актёров и/или героя. </p><p>Для чередования реплик - одни реплики вкладываются в другие. Сначала интерпретируется родительская реплика, а потом - все реплики-ответвления, являющиеся её дочерними репликами. При этом реплики актёра интерпретируются полностью, и фразы выводятся автоматически, а реплики героя интерпретируются частично и выводятся в виде действий. Когда игрок выбирает действие, реплика, на которой основано это действие, интерпретируется полностью.</p><p> Реплики, которые не содержат фразы, не выводятся на экран, однако их содержимое интерпретируется, как и содержимое реплик, которые содержат фразы.</p>
            <p>Список действий при интерпретации реплики обновляется только в том случае, если реплики героя вложены в одну актёрскую реплику.</p><p>Если интерпретируется реплика героя, в которую вложена реплика героя, то последняя выводится в виде действия, добавляемого в список без обновления списка действий. Пример:</p>

        <p class="em_PF"><span class="emTEXT">[:
    А если я захочу выбрать вариант вопроса, который исчез?
    <span class="emCOMM">&lt;!-- действие которое должно удаляться после выбора selectact.delete --&gt;</span>
    {:
        Весь наш разговор происходит в цикле, как только мы закончим обсуждать текущий вопрос,
        мы вернёмся к общему списку вопросов. Если хочешь, ты можешь сделать это прямо сейчас.
    :}
    [:
        <span class="emCOMM">&lt;!-- действие, которое должно появиться без очистки списка действий --&gt;</span>
        То есть, я могу спросить что-то другое?
        {:
            Да, конечно, спрашивай, что хочешь.
            <span class="emCOMM">&lt;!-- leveljump:other_question --&gt;</span>
        :}
    :]
:]</span></p>
            <p>Как отмечено выше, если не указана фраза реплики, реплика интерпретируется, но на экран ничего не выводится. Эта особенность позволяет создавать скрытые ветки. Для этого ветка размещается в пустой реплике героя. Пустые реплики героя не выводятся в виде действий.</p>
            <p>Чтобы пустая реплика героя всё же выводилась на экран в виде действия, название действия следует поместить между тегами <span class="emTEXT">act-name:&nbsp;:act-name</span>.</p>
            <p>Все фразы выводятся на экран с сохранением перевода строк. Следует учитывать это при организации диалога.</p>

            <a id="zna4enia-po-umol4aniu"></a><h3>Значения по умолчанию</h3>

            <p>Значения по умолчанию - это различные значения переменных настроек оформления и прочего, принимаемые тогда, когда явно заданные значения отсутствуют или ошибочны. Значения по умолчанию вшиты в механизм получения настроек.</p><p>Ниже перечислены настройки и значения по умолчанию.</p>
            <p class="em_TERMIN"><span>Имя</span>
                <br>Указывается между тегами <span class="emOPRT">name:&nbsp;:name</span>
                <br>по умолчанию, и для актёра и для героя: пустое значение, отсутствует, <span class="emOPRT">name::name</span>.</p>
            <p class="em_TERMIN"><span>Цвет имени</span>
                <br>Указывается после тега <span class="emOPRT">ncolor:</span>
                <br>по умолчанию, для актёра: чёрный, <span class="emOPRT">ncolor:<span class="emOPRT">000000</span></span>
                <br>по умолчанию, для героя: серый, <span class="emOPRT">ncolor:<span class="emOPRT">888888</span></span>.
            </p>
            <p class="em_TERMIN"><span>Аттрибуты имени</span>
                <br>Указывается после тега <span class="emOPRT">nattrib:</span>
                <br>по умолчанию, для актёра: жирный, <span class="emOPRT">nattrib:<span class="emOPRT">-b</span></span>
                <br>по умолчанию, для героя: жирный курсив, <span class="emOPRT">nattrib:<span class="emOPRT">-b-i</span></span>.
            </p>
            <p class="em_TERMIN"><span>Цвет фразы</span>
                <br>Указывается после тега <span class="emOPRT">fcolor:</span>
                <br>по умолчанию, для актёра: чёрный, <span class="emOPRT">fcolor:<span class="emOPRT">000000</span></span>
                <br>по умолчанию, для героя: серый, <span class="emOPRT">fcolor:<span class="emOPRT">888888</span></span>.
            </p>
            <p class="em_TERMIN"><span>Аттрибуты фразы</span>
                <br>Указывается после тега <span class="emOPRT">fattrib:</span>
                <br>по умолчанию, для актёра: нормальный, <span class="emOPRT">fattrib:</span>
                <br>по умолчанию, для героя: курсив, <span class="emOPRT">fattrib:<span class="emOPRT">-i</span></span>.
            </p>
            <p class="em_TERMIN"><span>Знак мыслеотделительный. Знак перед прямой речью</span><br>Указывается после тега <span class="emOPRT">tire:</span><br>по умолчанию, для актёра и героя: тире отбитое пробелами, <span class="emOPRT">tire:<span class="emOPRT"> — </span></span>.</p>
            <p class="em_TERMIN"><span>Режим повтора ответвлений</span><br>Указывается после тега <span class="emOPRT">repeat:</span><br>по умолчанию (только для актёрских реплик): по-кругу, непрерывное, <span class="emOPRT">repeat:<span class="emOPRT">cicle</span></span>.</p>
            <p class="em_TERMIN"><span>Режим выбора следующего ответвления</span><br>Указывается после тега <span class="emOPRT">shuffle:</span><br>по умолчанию (только для актёрских реплик): случайным образом, <span class="emOPRT">shuffle:<span class="emOPRT">random</span></span>.</p>

            <a id="podkluchenie_i_ispolzovanie"></a><h3>Подключение и использование</h3>

            <p>Файл модуля <span class="emFOLD">easy.dialog.qsp</span> поставляется вместе с файлом библиотеки <span class="emFOLD">easy.math.qsp</span> и работает только при наличии оного. Для использования модуля и библиотеки, оба файла подключаются к основному файлу игры:</p>
            <p class="em_CODE">
                <span class="emOPRT">addqst</span> <span class="emTEXT">'lib/easy.math.qsp'</span>
                <br/><span class="emOPRT">addqst</span> <span class="emTEXT">'lib/easy.dialog.qsp'</span>
            </p>
            <p>(в архиве оба файла помещены в папку "<span class="emFOLD">lib</span>". При подключении к игре вместо "<span class="emFOLD">lib/</span>" следует использовать настоящий относительный путь до файлов модуля и библиотеки.)</p>
            <p>Желательно включение режима распознавания html-тегов (<span class="emVAR">usehtml</span> = <span class="emNUM">1</span>).</p>
            <p>Диалоги для модуля пишутся в виде текстовых констант, или значений текстовых переменных. После чего константа или значение переменной передаются в качестве нулевого аргумента локации <span class="emFOLD">dialog.int</span>. Вызывать локацию следует через команду <span class="emOPRT">gosub</span>:</p>

            <p class="em_PF"><span class="emTEXT"><span class="emOPRT">gosub</span> <span class="emTEXT">'dialog.int'</span>, <span class="em_VIOL">$переменная_диалог</span>
<span class="emOPRT">gosub</span> <span class="emTEXT">'dialog.int'</span>, '
{:Короткий диалог
    [:Короткое действие:]
:}'</span></p>

            <p>При вызове <span class="emFOLD">dialog.int</span> будет очищено основное описание, список действий и дополнительное описание. После того как диалог будет закрыт, и описания и список действий восстановятся.</p>
            <p>При интерпретации реплики игнорируется преформатирование (символы пробелов и табуляций перед строками; строки не содержащие непробельных символов до первыой строки, содержащей непробельные символы, и после последней строки, содержащей непробельные символы).</p>
    </div>
    <div class="em_Epigraph">
        <div class="em_subText">
            <p>Aleks Versus'Easy Libraries'2019</p>
            <p>Aleks Versus'Game Adventure Making'Really Unimaginable Stories'2019</p>
        </div>
    </div>
</div>
</body>
</html>
