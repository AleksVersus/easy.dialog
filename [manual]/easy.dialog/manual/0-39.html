<!DOCTYPE html>
<html lang="ru">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<meta content="initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
<!-- TODO: favicon -->
<link href="../../res/css/easy.library.css" rel="stylesheet"/></head>
<body>
<div class="avs-page-wrapper">
<div class="easy-lib-page">
<article class="e-block">
<div class="avs-pages-button__wrapper">
<a class="avs-pages-button__link" href="../../easy.dialog/manual.html">
<div class="avs-pages-button">Назад</div>
</a>
<a class="avs-pages-button__link" href="../../easy.dialog/manual/0-40.html">
<div class="avs-pages-button">Настройки диалога ⇨</div>
</a>
</div>
<h1 class="avs-article-h1">easy.dialog</h1>
<p class="avs-articles-underhead">Подробное руководство по использованию модуля, с примерами. Страница первая</p>
<a id="podklu4enie" name="podklu4enie"></a>
<h2 class="avs-article-h2">Подключение</h2>
<p class="avs-article-p">Предполагается, что вы уже пробовали писать игры на QSP, знаете основные команды и, возможно, знаете, что такое функции, переменные и массивы и как формируется html-форматирование. Впрочем, можно обойтись и без последнего.</p>
<p class="avs-article-p">Модуль поставляется в комплекте с библиотекой easy.math.qsp и без неё работать не будет.</p>
<p class="avs-article-p">Чтобы подключить модуль к своей игре, нужно:</p>
<ol>
<li>Скачать архив и извлечь его содержимое в папку с вашей игрой. В папке с вашей игрой должна появиться папка "lib".
            <ul>
<li>После знакомства с примерами файл "<code class="em-folder">game.easy.dialog.qsp</code>" можно удалить.</li>
</ul>
</li>
<li>Проверить в папке "lib" наличие файлов "<code class="em-folder">easy.dialog.qsp</code>" и "<code class="em-folder">easy.math.qsp</code>".</li>
<li>Открыть файл своей игры (например с помощью QGen) и на самой первой локации ввести две строки:
            <pre class="Monokai-Code">
              <span class="Monokai-Operator">addqst</span> <span class="Monokai-String">'lib/easy.dialog.qsp'</span><br/>
              <span class="Monokai-Operator">addqst</span> <span class="Monokai-String">'lib/easy.math.qsp'</span>
            </pre>
</li>
<li>Сохранить свою игру.</li>
</ol>
<p class="avs-article-p">Теперь при запуске вашей игры, модуль "easy.dialog" и библиотека "easy.math" будут подключаться к игре автоматически.</p>
<p class="avs-article-p-warning"><strong>Внимание!!!</strong> При подключении библиотек к своей игре будьте внимательны. К игре добавляются только те локации, названия которых отсутствуют в вашей игре. Просмотрите список локаций в подключаемых библиотеках, чтобы предупредить совпадения имён.</p>
<a id="easydialog" name="easydialog"></a>
<h2 class="avs-article-h2">Простые диалоги</h2>
<p class="avs-article-p">Чтобы использовать модуль, нужно знать, как написать диалог, чтобы модуль вас понял.</p>
<p class="avs-article-p">Диалоги пишутся предельно просто и не требуют специальных знаний, кроме тех, которые Вы получите сейчас.</p>
<p class="avs-article-p">Диалог - это разговор, как правило, двух персонажей. В игре один персонаж - это герой, которым управляет игрок, другой персонаж - неиграбельный, т.е. игрок условно не может им управлять. Персонаж игрока мы будем называть героем, а персонаж, с которым герой вступает в диалог, просто персонажем, актёром, или неписью (от англ. NPC - non-playable character).</p>
<p class="avs-article-p">Фразы, доступные игроку (и соответственно герою), должны выводиться в виде списка действий, доступных для выбора и выполнения. А фразы актёра должны выводиться непосредственно на экран автоматически. Собственно это все различия между одним типом фраз и другим.</p>
<p class="avs-article-p">Итак, у нас есть фразы NPC, которые выводятся автоматически, и фразы героя, которые появляются в виде действий и не используются в диалоге, пока игрок не выберет одну из них. Оба типа фраз помещаются между специальными метками. Я называю их тегами.</p>
<p class="avs-article-p">
<code class="em-string">{: Фраза, которую будет произносить неиграбельный персонаж :}</code> — фигурная скобка, двоеточие, потом идёт реплика персонажа, потом двоеточие и снова фигурная скобка. "<code class="em-string">{:</code>" - открывающий тег. "<code class="em-string">:}</code>" - закрывающий тег. Всё, что произносит актёр, помещаем между такими тегами. Каждая отдельная фраза должна помещаться между тегами. Например:</p>
<pre class="Monokai-Code">
        <span class="Monokai-String">{: Сегодня прекрасная погода. :}</span><br/>
        <span class="Monokai-String">{: Не думал я, что будет дождь! :}</span><br/>
        <span class="Monokai-String">{: На город набегают тучи, осенний сплин кого-то мучит... :}</span>
        </pre>
<p class="avs-article-p">
<code class="em-string">[: Фраза, которая превратится в действие, а когда игрок выберет действие, станет репликой в диалоге. :]</code> — квадратная скобка, двоеточие, потом идёт реплика героя, снова двоеточие, квадратная скобка. "<code class="em-string">[:</code>" - открывающий тег, "<code class="em-string">:]</code>" - закрывающий тег. Всё, что может сказать герой, помещаем между такими тегами. Опять же, каждая отдельная фраза - в отдельных тегах. И каждая такая фраза будет выведена одним действием.
        </p>
<p class="avs-article-p">Фразы героя и актёра можно располагать одна в другой, или несколько в одной. Мало того, можно располагать фразы одного типа друг в друге.</p>
<p class="avs-article-p">Зачем это нужно? А вот зачем: диалог собирается и распознаётся по принципу вопрос-ответ. Допустим, реплика актёра - это вопрос, а реплика героя должна быть ответом на вопрос. Но игроку можно предложить несколько вариантов ответов на вопрос. Чтобы написать такой простой диалог: вопрос и несколько ответов, - делаем так:</p>
<p class="avs-article-p">Первым делом пишем вопрос. Например, непись должна спросить героя "Как тебя зовут?". Пишем:</p>
<pre class="Monokai-Code">
        <span class="Monokai-String">{: Как тебя зовут? :}</span>
        </pre>
<p class="avs-article-p">А теперь ответы на вопрос "вкладываем" в вопрос:</p>
<pre class="Monokai-Code">
        <span class="Monokai-String">{: Как тебя зовут? <br/>
           [:Вася:]<br/>
           [:Петя:]<br/>
           [:Не твоё дело!:]<br/>
           [:Я забыл...:]<br/>
        :}</span>
        </pre>
<p class="avs-article-p">   На экран выведется реплика актёра "Как тебя зовут?" и четыре действия. При щелчке на любом из действий, герой будет произносить фразу, написанную в этих репликах. Например, если игрок выберет действие "Я забыл...", на экран выведется фраза героя "Я забыл...".</p>
<p class="avs-article-p">Как сделать так, чтобы по щелчку на действии произносил фразу не только герой, но и актёр? Всё тем же способом. "Вложить" реплику актёра в реплику героя. Разовьём предыдущий пример:</p>
<pre class="Monokai-Code">
        <span class="Monokai-String">{: Как тебя зовут? <br/>
           [:Вася:]<br/>
           [:Петя:]<br/>
           [:Не твоё дело!:]<br/>
           [:А тебя как?<br/>
              {:Меня Васькой Пупкиным кличут:}<br/>
           :]<br/>
        :}</span>
        </pre>
<p class="avs-article-p">Таким образом, вкладывая реплики друг в друга, вы можете создавать большие ветвистые диалоги. Для примера, вот небольшой ветвистый диалог, на котором отрабатывались первые сборки модуля:</p>
<pre class="Monokai-Code">
        <span class="Monokai-String">{:<br/>
           Как вас зовут?<br/>
           [:<br/>
              Меня зовут Вася.<br/>
              {:Вас зовут Вася?<br/>
                 [:Да, меня зовут Вася.<br/>
                    {:да ну нафиг:}<br/>
                    [:<br/>
                    нет. чистая правда<br/>
                    :]<br/>
                 :]<br/>
                 [:Нет, никто меня так не зовёт:]<br/>
              :}<br/>
              {:<br/>
                 Это правда, что вас зовут Васей?<br/>
                 [:Правда<br/>
                 :]<br/>
                 [:Неправда:]<br/>
              :}<br/>
           :]<br/>
           [:<br/>
              Меня зовут Петя.<br/>
              {:<br/>
                 Вас зовут Петя?<br/>
                 [:Да{:Как это удобно!:}:]<br/>
                 [:<br/>
                    Нет<br/>
                    {:Вас зовут не Петя? Как неудобно!:}<br/>
                 :]<br/>
              :}<br/>
              {:<br/>
                 Это правда, что вас зовут Петей?<br/>
                 [:Правда:]<br/>
                 [:Неправда:]<br/>
              :}<br/>
              {:Неужели в самом деле Петей Вас зовут?<br/>
                 [:В самом деле:]<br/>
                 [:Нет, не в самом:]<br/>
              :}<br/>
           :]<br/>
        :}</span>
        </pre>
<p class="avs-article-p">Обратите внимание на то, как записаны фразы, которые должны выводиться на экран в диалоге. Перед ними есть пустые строки, символы пробелов и табуляций. Модуль сам очистит фразы от мусора и уберёт пустые строки перед фразой и после неё, а так же пробельные символы перед каждой строкой и после неё. То есть даже если вы вставите фразу между тегами вот так:</p>
<pre class="Monokai-Code"><span class="Monokai-String">
        {:<br/>
        <br/>
        <br/>
        <br/>
        <br/>
        <br/>
        <br/>
        <br/>
                          Как вас зовут?<br/>
        <br/>
        <br/>
        <br/>
        <br/>
        <br/>
        <br/>
        :}
        </span></pre>
<p class="avs-article-p">То на экран всё равно будет выведено: "Как вас зовут?" без пробелов перед репликой и пустых строк.</p>
<a id="zapusk_dialoga" name="zapusk_dialoga"></a>
<h2 class="avs-article-h2">Запуск диалога</h2>
<p class="avs-article-p">Теперь, когда Вы знаете, как составлять диалог, нужно освоить его запуск и уяснить некоторые особенности вывода диалога на экран.</p>
<p class="avs-article-p">Текст диалога лучше присвоить какой-нибудь переменной. Например:</p>
<pre class="Monokai-Code">
        <span class="Monokai-UnFunc">$диалог_старушки</span> = <span class="Monokai-String">"{:Добрый вечер, милок.<br/>
           [:<br/>
              Здравствуйте, бабуся!<br/>
           :]<br/>
           [:<br/>
              Девушка, мы разве знакомы?<br/>
           :]<br/>
        :}"</span></pre>
<p class="avs-article-p">Далее делаем вызов диалога командой gosub</p>
<pre class="Monokai-Code">
              <span class="Monokai-Operator">gosub</span> <span class="Monokai-String">'dialog.int'</span>, <span class="Monokai-UnFunc">$диалог_старушки</span>
            </pre>
<p class="avs-article-p">
<code class="em-operator">gosub</code> - это команда обращения к локации. Плеер обращается к локации "<code class="em-folder">dialog.int</code>", выполнет на ней весь код и возвращается обратно. После запятой стоит переменная <code class="em-folder">$диалог_старушки</code>, в которую, как вы помните, мы поместили диалог. Значение этой переменной будет передано локации "<code class="em-folder">dialog.int</code>" для обработки.</p>
<p class="avs-article-p">При вызове диалога автоматически очистится окно основного описания, окно дополнительного описания и список действий. Когда диалог будет закончен, всё восстановится обратно: и основное и дополнительное описание, и действия даже.</p>
<div class="avs-pages-button__wrapper">
<a class="avs-pages-button__link" href="../../easy.dialog/manual.html">
<div class="avs-pages-button">Назад</div>
</a>
<a class="avs-pages-button__link" href="../../easy.dialog/manual/0-40.html">
<div class="avs-pages-button">Настройки диалога ⇨</div>
</a>
</div>
</article>
<aside class="e-block">
<div class="avs-page-stamp">
<p class="avs-empty">Aleks Versus'Easy Libraries'2013-<span class="subscribe-year">2024</span></p>
<p class="avs-empty">Aleks Versus'Game Adventure Making'Really Unimaginable Stories'2013-<span class="subscribe-year">2024</span></p>
</div>
</aside>
</div>
</div></body>
</html>